# ROI 分析与成本优化功能说明

## 📋 功能概述

ROI 分析与成本优化模块是 GEO 工具的核心功能之一，用于量化 GEO 投入产出比，优化成本结构，帮助用户数据驱动决策。

### 核心价值

- **量化价值**：帮助用户了解 GEO 投入产出比，清楚看到投入产出
- **优化成本**：识别哪些关键词/平台 ROI 最高，优化预算分配
- **数据驱动**：基于数据分析提供成本优化建议
- **预算管理**：成本预警和未来成本预测

## 🎯 功能位置

### Tab6（AI 数据报表）- ROI 分析与成本优化模块

在 Tab6 中，ROI 分析与成本优化模块位于话题集群分析之后、关键词效果排名之前。

## 🔄 工作流程

### 1. 自动成本记录

系统会自动记录所有 API 调用成本：

1. **内容生成**：生成关键词、内容时自动记录成本
2. **内容验证**：验证品牌提及率时自动记录成本
3. **内容优化**：优化文章时自动记录成本
4. **其他操作**：语义扩展、话题聚类等操作也会记录成本

### 2. 查看成本分析

1. **成本概览**：查看总成本、总 Token 数、API 调用次数
2. **成本趋势**：查看每日成本趋势图
3. **成本分布**：按提供商、操作类型、关键词、平台统计成本
4. **ROI 分析**：查看 ROI 比率、估算价值、关键词 ROI 排名

### 3. 获取优化建议

系统会根据成本数据自动生成优化建议：
- 高成本提供商替代建议
- 负 ROI 关键词识别
- 操作类型成本优化建议

### 4. 未来成本预测

基于历史数据预测未来成本：
- 预计日均成本
- 预计 30 天总成本
- 预测置信度

## 📊 功能模块

### 成本概览

显示关键成本指标：
- **总成本(CNY)**：人民币总成本
- **总成本(USD)**：美元总成本
- **总Token数**：累计使用的 Token 数量
- **API调用次数**：累计 API 调用次数

### 成本趋势图

可视化展示每日成本趋势：
- 折线图显示每日成本变化
- 帮助识别成本波动模式
- 支持时间范围筛选

### 成本分布分析

#### 按提供商统计

- 饼图展示各提供商的成本占比
- 识别高成本提供商
- 提供替代建议

#### 按操作类型统计

- 柱状图展示各操作类型的成本分布
- 识别高成本操作
- 优化操作策略

#### 按关键词统计

- 统计每个关键词的成本
- 识别高成本关键词
- 优化关键词策略

#### 按平台统计

- 统计各内容平台的成本
- 识别高成本平台
- 优化平台选择

### ROI 分析

#### ROI 指标

- **总投入成本**：累计投入的总成本
- **总提及次数**：品牌被提及的总次数
- **估算价值**：基于提及次数估算的价值
- **ROI 比率**：投资回报率百分比
- **ROI 价值**：净收益（价值 - 成本）

#### 关键词 ROI 排名

- 按 ROI 排序的关键词列表
- 显示每个关键词的成本、提及次数、估算价值、ROI
- 识别高 ROI 和负 ROI 关键词

### 成本优化建议

系统自动生成优化建议，包括：

1. **提供商优化**
   - 识别高成本提供商
   - 建议使用更经济的替代方案
   - 估算可节省成本

2. **关键词优化**
   - 识别负 ROI 关键词
   - 建议暂停或优化低 ROI 关键词
   - 列出具体关键词

3. **操作类型优化**
   - 识别高成本操作
   - 建议减少验证频率或使用更便宜的模型
   - 估算可节省成本

### 未来成本预测

基于历史数据预测未来成本：
- **预计日均成本**：基于历史数据计算的日均成本
- **预计30天总成本**：未来 30 天的总成本预测
- **预测置信度**：基于数据点数量的置信度评估

## 💰 成本计算

### Token 估算

系统使用简化的方法估算 Token 数量：
- **中文**：约 1.5 字符 = 1 token
- **英文**：约 4 字符 = 1 token
- **混合文本**：按比例计算

### 定价配置

系统内置了各平台的 API 定价配置（每 1K tokens，USD）：

- **DeepSeek**：$0.14/1M input, $0.28/1M output
- **OpenAI GPT-4**：$30/1M input, $60/1M output
- **OpenAI GPT-4 Turbo**：$10/1M input, $30/1M output
- **OpenAI GPT-3.5 Turbo**：$0.5/1M input, $1.5/1M output
- **通义千问**：$2/1M input, $8/1M output (qwen-plus)
- **Groq**：免费
- **Moonshot (Kimi)**：$12/1M (moonshot-v1-8k)
- **豆包**：$0.8/1M input, $2/1M output (doubao-pro-4k)
- **文心一言**：$12/1M (ernie-4.0)

**注意**：这些是示例价格，实际价格可能不同。可以在 `modules/roi_analyzer.py` 中更新定价配置。

### 成本计算公式

```
成本(USD) = (输入Token数 / 1000) × 输入价格 + (输出Token数 / 1000) × 输出价格
成本(CNY) = 成本(USD) × 汇率（默认 7.2）
```

## 📈 ROI 计算

### ROI 估算方法

系统使用简化的方法估算 ROI：

1. **提及价值估算**
   - 每次品牌提及的价值 = 固定值（默认 ¥10，可配置）
   - 总价值 = 提及次数 × 每次提及价值

2. **ROI 计算**
   - ROI 比率 = (估算价值 - 总成本) / 总成本 × 100%
   - ROI 价值 = 估算价值 - 总成本

3. **关键词 ROI**
   - 每个关键词的成本和提及次数单独统计
   - 计算每个关键词的 ROI

**注意**：ROI 估算是简化的方法，实际价值可能因行业、品牌等因素而异。用户可以根据实际情况调整 `mention_value_per_mention` 参数。

## 💡 使用建议

### 1. 定期查看成本

- 建议每周查看一次成本分析
- 关注成本趋势变化
- 及时发现异常成本

### 2. 优化高成本操作

- 关注成本分布分析
- 识别高成本提供商、操作类型
- 根据优化建议调整策略

### 3. 关注 ROI 指标

- 定期查看 ROI 分析
- 识别高 ROI 和负 ROI 关键词
- 优化低 ROI 关键词的策略

### 4. 使用成本预测

- 基于历史数据预测未来成本
- 合理规划预算
- 注意预测置信度

### 5. 导出数据

- 定期导出成本数据
- 生成成本分析报告
- 用于内部汇报和决策

## ⚠️ 注意事项

1. **Token 估算精度**：系统使用简化的方法估算 Token 数量，可能与实际值有差异
2. **定价配置**：内置定价是示例价格，需要根据实际情况更新
3. **ROI 估算**：ROI 估算是简化的方法，实际价值可能因行业而异
4. **数据积累**：需要积累一定数据后才能进行准确的分析和预测
5. **汇率**：默认使用 7.2 的汇率，可以在 `ROIAnalyzer` 初始化时调整

## 🔗 相关功能

- **数据持久化**：成本数据自动保存到数据库
- **AI 数据报表**：在 Tab6 查看完整的成本分析
- **历史记录**：在 Tab5 查看历史数据

## 🎯 最佳实践

1. **定期监控**：每周查看一次成本分析，及时发现问题
2. **优化策略**：根据成本分布和 ROI 分析优化内容策略
3. **预算规划**：使用成本预测功能合理规划预算
4. **数据导出**：定期导出成本数据，用于内部汇报
5. **调整配置**：根据实际情况更新定价配置和 ROI 估算参数

## 📈 预期效果

### 短期效果

- **成本透明**：清楚了解每次操作的成本
- **优化决策**：基于数据优化内容策略
- **预算控制**：合理控制 API 调用成本

### 长期效果

- **成本优化**：持续优化成本结构，提升 ROI
- **数据积累**：积累历史数据，提升分析准确性
- **策略优化**：基于 ROI 数据优化整体内容策略

---

**版本**：v1.0  
**更新日期**：2025-01-26
